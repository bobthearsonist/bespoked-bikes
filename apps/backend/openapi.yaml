openapi: 3.0.3
info:
  title: BeSpoked Bikes API
  description: API for BeSpoked Bikes sales tracking system
  version: 1.0.0
servers:
  - url: http://localhost:5000
    description: Development server

paths:
  /api/customers:
    post:
      tags:
        - Customers
      summary: Create a new customer
      operationId: createCustomer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerDto'
      responses:
        '201':
          description: Customer created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerDto'
    get:
      tags:
        - Customers
      summary: Search customers
      operationId: searchCustomers
      parameters:
        - name: searchTerm
          in: query
          schema:
            type: string
      responses:
        '200':
          description: List of customers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CustomerDto'

  /api/customers/{id}:
    get:
      tags:
        - Customers
      summary: Get customer by ID
      operationId: getCustomerById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Customer details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerDto'
        '404':
          description: Customer not found
    put:
      tags:
        - Customers
      summary: Update customer
      operationId: updateCustomer
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerDto'
      responses:
        '200':
          description: Customer updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerDto'

  /api/salespeople:
    post:
      tags:
        - Salespeople
      summary: Create a new salesperson
      operationId: createSalesperson
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SalespersonDto'
      responses:
        '201':
          description: Salesperson created successfully
    get:
      tags:
        - Salespeople
      summary: List salespeople
      operationId: listSalespeople
      responses:
        '200':
          description: List of salespeople

  /api/salespeople/{id}:
    get:
      tags:
        - Salespeople
      summary: Get salesperson by ID
      operationId: getSalespersonById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Salesperson details
    put:
      tags:
        - Salespeople
      summary: Update salesperson
      operationId: updateSalesperson
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SalespersonDto'
      responses:
        '200':
          description: Salesperson updated successfully

  /api/products:
    post:
      tags:
        - Products
      summary: Create a new product
      operationId: createProduct
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductDto'
      responses:
        '201':
          description: Product created successfully
    get:
      tags:
        - Products
      summary: List products
      operationId: listProducts
      responses:
        '200':
          description: List of products

  /api/products/{id}:
    get:
      tags:
        - Products
      summary: Get product by ID
      operationId: getProductById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Product details
    put:
      tags:
        - Products
      summary: Update product
      operationId: updateProduct
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductDto'
      responses:
        '200':
          description: Product updated successfully

  /api/products/{id}/inventory:
    put:
      tags:
        - Products
      summary: Update product inventory
      operationId: updateProductInventory
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Inventory updated successfully

  /api/sales:
    post:
      tags:
        - Sales
      summary: Create a new sale
      operationId: createSale
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaleDto'
      responses:
        '201':
          description: Sale created successfully
    get:
      tags:
        - Sales
      summary: Get sales by date range
      operationId: getSalesByDateRange
      parameters:
        - name: startDate
          in: query
          schema:
            type: string
            format: date-time
        - name: endDate
          in: query
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: List of sales

  /api/sales/{id}:
    get:
      tags:
        - Sales
      summary: Get sale by ID
      operationId: getSaleById
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Sale details

  /api/reports/commissions/quarterly:
    get:
      tags:
        - Reports
      summary: Get quarterly commission report
      operationId: getQuarterlyCommissions
      parameters:
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: quarter
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
            maximum: 4
      responses:
        '200':
          description: Quarterly commission report

  /api/reports/commissions/salesperson/{id}/quarterly:
    get:
      tags:
        - Reports
      summary: Get salesperson quarterly commission report
      operationId: getSalespersonQuarterlyCommissions
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: year
          in: query
          required: true
          schema:
            type: integer
        - name: quarter
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
            maximum: 4
      responses:
        '200':
          description: Salesperson quarterly commission report

components:
  schemas:
    CustomerDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
          format: email
        phone:
          type: string
        address:
          type: string
        city:
          type: string
        state:
          type: string
        postalCode:
          type: string
      required:
        - name
        - email

    SalespersonDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        employeeId:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
          format: email
        phone:
          type: string
        startDate:
          type: string
          format: date-time
        terminationDate:
          type: string
          format: date-time
          nullable: true
      required:
        - firstName
        - lastName
        - email

    ProductDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        productType:
          type: string
        name:
          type: string
        description:
          type: string
        manufacturer:
          type: string
        costPrice:
          type: number
          format: decimal
        retailPrice:
          type: number
          format: decimal
        commissionPercentage:
          type: number
          format: decimal
      required:
        - name
        - productType
        - manufacturer

    SaleDto:
      type: object
      properties:
        id:
          type: string
          format: uuid
        customerId:
          type: string
          format: uuid
        salespersonId:
          type: string
          format: uuid
        productId:
          type: string
          format: uuid
        salePrice:
          type: number
          format: decimal
        commissionAmount:
          type: number
          format: decimal
        saleChannel:
          type: string
        location:
          type: string
        saleDate:
          type: string
          format: date-time
      required:
        - customerId
        - salespersonId
        - productId
        - salePrice
