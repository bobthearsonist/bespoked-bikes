name: PR CI/CD Pipeline

on:
  pull_request:
    branches:
      - main
      - develop

jobs:
  # Backend tests run in parallel
  backend-unit-tests:
    name: Backend Unit Tests
    permissions:
      contents: read
    uses: ./.github/workflows/backend-test.yml
    with:
      test-type: unit
  
  backend-integration-tests:
    name: Backend Integration Tests
    permissions:
      contents: read
    uses: ./.github/workflows/backend-test.yml
    with:
      test-type: integration
  
  # Frontend tests run in parallel (placeholder for when frontend is added)
  frontend-unit-tests:
    name: Frontend Unit Tests
    runs-on: ubuntu-latest
    permissions: {}
    steps:
      - name: Placeholder
        run: |
          echo "Frontend unit tests will run here when frontend is implemented"
          echo "Tests will be run with coverage enabled and reports will be uploaded as artifacts"
          echo "Skipping for now as no frontend exists yet"
  
  frontend-integration-tests:
    name: Frontend Integration Tests
    runs-on: ubuntu-latest
    permissions: {}
    steps:
      - name: Placeholder
        run: |
          echo "Frontend integration tests will run here when frontend is implemented"
          echo "Tests will be run with coverage enabled and reports will be uploaded as artifacts"
          echo "Skipping for now as no frontend exists yet"
  
  # System tests run after all other tests complete
  system-tests:
    name: System Tests
    runs-on: ubuntu-latest
    permissions: {}
    needs: 
      - backend-unit-tests
      - backend-integration-tests
      - frontend-unit-tests
      - frontend-integration-tests
    steps:
      - name: Placeholder for system tests
        run: |
          echo "System tests will run here once containers are set up"
          echo "This job ensures all component tests pass before running end-to-end tests"
